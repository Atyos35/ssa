doctrine:
    dbal:
        # Utiliser PostgreSQL pour les tests (comme en production)
        driver: pdo_pgsql
        url: '%env(resolve:DATABASE_URL)%'
        server_version: '16'
        charset: utf8
        
        # Configuration pour les tests
        options:
            # Désactiver la validation stricte pour les tests
            PDO::ATTR_ERRMODE: PDO::ERRMODE_EXCEPTION
            
        # Gestion des erreurs de connexion
        exception_on_missing_collection: false
        
        # Configuration de fallback si pas de base de données
        # Les tests d'intégration échoueront mais les tests unitaires fonctionneront
        
    orm:
        auto_generate_proxy_classes: true
        report_fields_where_declared: true
        validate_xml_mapping: true
        naming_strategy: doctrine.orm.naming_strategy.underscore_number_aware
        auto_mapping: true
        mappings:
            App:
                type: attribute
                is_bundle: false
                dir: '%kernel.project_dir%/src/Domain/Entity'
                prefix: 'App\Domain\Entity'
                alias: App
                
        # Configuration pour les tests
        dql:
            string_functions:
                # Fonctions personnalisées si nécessaire
                
        # Désactiver certaines fonctionnalités en test
        enable_lazy_ghost_objects: false
